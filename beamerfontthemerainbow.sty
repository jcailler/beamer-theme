\RequirePackage{iftex}
\RequirePackage{fontawesome5}
\RequirePackage{relsize}

\ifPDFTeX%
	\PackageError{rainbow}%
	{PDFTeX is unsupported (at least for now) since our template needs to load some fonts.}%
	{}
\else%
	\RequirePackage[
		warnings-off={mathtools-colon,mathtools-overbracket}
	]{unicode-math}
	\RequirePackage{fontspec}

	\IfStrEq{\rainbow@fonts@main}{\@empty}{%
		%% If no custom main font has been requested
		\setmainfont[ItalicFont={Fira Sans Light Italic},%
			BoldFont={Fira Sans},%
			BoldItalicFont={Fira Sans Italic}]%
		{Fira Sans Light}%
	}{%
		\expandafter\setmainfont\rainbow@fonts@main
	}

	\IfStrEq{\rainbow@fonts@sans}{\@empty}{%
		%% If no custom sans font has been requested
		\setsansfont[ItalicFont={Fira Sans Light Italic},%
			BoldFont={Fira Sans},%
			BoldItalicFont={Fira Sans Italic}]%
		{Fira Sans Light}%
	}{%
		\expandafter\setsansfont\rainbow@fonts@sans
	}

	\IfStrEq{\rainbow@fonts@mono}{\@empty}{%
		%% If no custom mono font has been requested
		\setmonofont[BoldFont={Fira Mono Medium}]{Fira Mono}%
	}{%
		\expandafter\setmonofont\rainbow@fonts@mono
	}

	\IfStrEq{\rainbow@fonts@math}{\@empty}{%
		%% If no custom math font has been requested
		\setmathfont{Fira Math}
	}{%
		\expandafter\setmathfont\rainbow@fonts@math%
	}
\fi

\setbeamerfont*{structure}{size=\small}%,series=\bfseries\boldmath}

\setbeamerfont*{frametitle}{size=\large,parent=structure}
\setbeamerfont*{framesubtitle}{size=\large,parent=frametitle}

\setbeamerfont*{footline}{size=\tiny, family=\sffamily}

\setbeamerfont*{title}{size=\LARGE, family=\sffamily, series=\bfseries}
\setbeamerfont*{subtitle}{size=\normalsize, family=\sffamily}
\setbeamerfont*{author}{size=\small, family=\rmfamily}
\setbeamerfont*{titlepage date}{size=\small, parent=author}

\setbeamerfont*{section in toc}{parent=structure}
\setbeamerfont*{subsection in toc}{parent=structure}

\setbeamerfont*{itemize item}{parent=structure, series=\bfseries\boldmath}
\setbeamerfont*{enumerate item}{parent=structure, series=\bfseries\boldmath}

\setbeamerfont*{block title}{family=\rmfamily, size=\small}
\setbeamerfont*{block title example}{family=\rmfamily, size=\small}
\setbeamerfont*{block title alerted}{family=\rmfamily, size=\small}
\setbeamerfont*{block body}{size=\small}
\setbeamerfont*{block body example}{size=\small}
\setbeamerfont*{block body alerted}{size=\small}

\setbeamerfont*{itemize item}{parent=structure, series=\bfseries\boldmath}
\setbeamerfont*{enumerate item}{parent=structure, series=\bfseries\boldmath}

\setbeamerfont*{qed symbol}{size=\footnotesize, series=\boldmath}

\BeforeBeginEnvironment{lemma}{%
	\let\theoremicon\faCheckCircle%
}
\BeforeBeginEnvironment{theorem}{%
	\let\theoremicon\faCheckCircle%
}
\BeforeBeginEnvironment{definition}{%
	\let\theoremicon\faCrosshairs%
}

\setbeamerfont*{button}{size=\scriptsize, family=\rmfamily}
\renewcommand\insertgotosymbol{{\smaller\faShare}\ \ }
\renewcommand\insertskipsymbol{{\smaller\faAngleDoubleRight}\ \ }
\renewcommand\insertreturnsymbol{{\smaller\faReply}\ \ }